(function(e){function t(t){for(var a,r,c=t[0],s=t[1],i=t[2],l=0,d=[];l<c.length;l++)r=c[l],u[r]&&d.push(u[r][0]),u[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);f&&f(t);while(d.length)d.shift()();return o.push.apply(o,i||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,r=1;r<n.length;r++){var c=n[r];0!==u[c]&&(a=!1)}a&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={app:0},u={app:0},o=[];function c(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-09fb40aa":"41320ece","chunk-0ab3d7eb":"344d3bd8","chunk-2d20ec05":"6ca7b5bb","chunk-952425b4":"e043660a","chunk-a4aea362":"e5ab71c3","chunk-f809d948":"d1037dcd","chunk-2d22d746":"6ac72176","chunk-357d883b":"059cf012","chunk-35ce3fa2":"653a464b","chunk-534068b0":"d9048a2a","chunk-58e66fec":"f5dd06ae","chunk-5cd09936":"b29dced3","chunk-628e6a2a":"da109343","chunk-7b9a9d51":"dac82407","chunk-8c4d3afa":"70008b27","chunk-a5d9095a":"f44824b2","chunk-ca4bd1ba":"2de0bf56"}[e]+".js"}function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n={"chunk-09fb40aa":1,"chunk-0ab3d7eb":1,"chunk-952425b4":1,"chunk-a4aea362":1,"chunk-f809d948":1,"chunk-357d883b":1,"chunk-35ce3fa2":1,"chunk-534068b0":1,"chunk-58e66fec":1,"chunk-5cd09936":1,"chunk-628e6a2a":1,"chunk-7b9a9d51":1,"chunk-8c4d3afa":1,"chunk-a5d9095a":1,"chunk-ca4bd1ba":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise(function(t,n){for(var a="css/"+({}[e]||e)+"."+{"chunk-09fb40aa":"f18ab034","chunk-0ab3d7eb":"6695d72a","chunk-2d20ec05":"31d6cfe0","chunk-952425b4":"9bbd589f","chunk-a4aea362":"074e4438","chunk-f809d948":"2de1d30f","chunk-2d22d746":"31d6cfe0","chunk-357d883b":"79a05b13","chunk-35ce3fa2":"df813de2","chunk-534068b0":"5ee8912c","chunk-58e66fec":"0aa53445","chunk-5cd09936":"96eab8f1","chunk-628e6a2a":"212ee0bd","chunk-7b9a9d51":"669802ea","chunk-8c4d3afa":"ebd81972","chunk-a5d9095a":"4ea90f09","chunk-ca4bd1ba":"55d21999"}[e]+".css",u=s.p+a,o=document.getElementsByTagName("link"),c=0;c<o.length;c++){var i=o[c],l=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(l===a||l===u))return t()}var d=document.getElementsByTagName("style");for(c=0;c<d.length;c++){i=d[c],l=i.getAttribute("data-href");if(l===a||l===u)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var a=t&&t.target&&t.target.src||u,o=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");o.request=a,delete r[e],f.parentNode.removeChild(f),n(o)},f.href=u;var h=document.getElementsByTagName("head")[0];h.appendChild(f)}).then(function(){r[e]=0}));var a=u[e];if(0!==a)if(a)t.push(a[2]);else{var o=new Promise(function(t,n){a=u[e]=[t,n]});t.push(a[2]=o);var i,l=document.getElementsByTagName("head")[0],d=document.createElement("script");d.charset="utf-8",d.timeout=120,s.nc&&d.setAttribute("nonce",s.nc),d.src=c(e),i=function(t){d.onerror=d.onload=null,clearTimeout(f);var n=u[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src,o=new Error("Loading chunk "+e+" failed.\n("+a+": "+r+")");o.type=a,o.request=r,n[1](o)}u[e]=void 0}};var f=setTimeout(function(){i({type:"timeout",target:d})},12e4);d.onerror=d.onload=i,l.appendChild(d)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/efco/",s.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var d=0;d<i.length;d++)t(i[d]);var f=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},2925:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("96cf");var a=n("1da1"),r=(n("cadf"),n("551c"),n("097d"),n("2b0e")),u=n("bc3a"),o=n.n(u),c=n("a7fe"),s=n.n(c),i=n("5c96"),l=n.n(i),d=n("dccd"),f=n.n(d),h=n("0a89"),p=n.n(h),b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.$router.currentRoute.meta.dashboard?e._e():n("topbar"),e.isConfirmationFailure?n("el-alert",{staticClass:"global-notice",attrs:{title:"Код подтверждения недействителен!",type:"warning","show-icon":""}}):e._e(),e.isConfirmed?n("el-alert",{staticClass:"global-notice",attrs:{type:"success","show-icon":"",title:"Вы успешно подтвердили аккаунт!"}}):e._e(),n("router-view",{staticClass:"view"}),e.$router.currentRoute.meta.dashboard?e._e():n("v-footer")],1)},m=[],k=n("be94"),v=n("2f62"),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Topbar topbar"},[a("div",{staticClass:"group left"},[a("router-link",{staticClass:"item logo",attrs:{exact:"",to:"/"}},[a("img",{attrs:{src:n("cf05")}}),a("span",[e._v("Эффективная команда")])])],1),a("div",{staticClass:"group right"},[a("router-link",{staticClass:"item",attrs:{to:{name:"Surveys"}}},[e._v("\n      Опросы\n    ")]),a("router-link",{staticClass:"item",attrs:{to:{name:"Appeals"},exact:""}},[e._v("\n      Обращение\n    ")]),a("div",{staticClass:"divider"}),e.current_user?e._e():[a("router-link",{staticClass:"item login",attrs:{to:"/login"}},[e._v("Войти")]),a("el-button",{staticClass:"registration",attrs:{type:"primary",size:"small"},on:{click:function(t){e.$router.push("/registration")}}},[e._v("Регистрация")])],e.current_user?a("router-link",{staticClass:"item full-height account",attrs:{to:{name:"Account"}}},[a("i",{staticClass:"fa fa-user"})]):e._e(),e.current_user&&e.current_user.admin?[a("div",{staticClass:"divider left right"}),a("el-tooltip",{attrs:{effect:"dark",content:"Панель управления"}},[a("router-link",{staticClass:"item dashboard full-height",attrs:{to:"/dashboard"}},[a("i",{staticClass:"fa fa-fw fa-cogs"})])],1)]:e._e()],2)])},y=[],_={data:function(){return{}},computed:Object(k["a"])({},Object(v["b"])("auth",["current_user"]))},w=_,S=(n("b18b"),n("2877")),C=Object(S["a"])(w,g,y,!1,null,"7c9a2f70",null);C.options.__file="Topbar.vue";var x=C.exports,$=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},j=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"Footer"},[n("div",[e._v("Эффективная Команда")]),n("div",[e._v("2018 ©")])])}],O={},P=O,E=(n("9f87"),Object(S["a"])(P,$,j,!1,null,"19e25b2d",null));E.options.__file="Footer.vue";var R=E.exports,T={metaInfo:{titleTemplate:"%s | Эффективная Команда"},components:{Topbar:x,VFooter:R},data:function(){return{isConfirmed:!1,isConfirmationFailure:!1}},computed:Object(k["a"])({},Object(v["b"])("auth",["current_user"])),mounted:function(){this.watchingRoute()},methods:{watchingRoute:function(){var e=this,t=this.$watch("$route",function(){t(),e.verificationCode(),e.$route.query.confirmation&&window.history.replaceState(null,null,"/#/")})},verificationCode:function(){var e=this.$route.query.confirmation;switch(!0){case"failure"===e:this.isConfirmationFailure=!0;break;case"success"===e:this.isConfirmed=!0,this.current_user||this.$router.push({name:"Login"});break;default:}}}},A=T,q=(n("5c0b"),Object(S["a"])(A,b,m,!1,null,null,null));q.options.__file="App.vue";var D=q.exports,N=(n("7f7f"),n("8c4f")),I={namespaced:!0,state:{current_user:null,token:null},mutations:{authenticate:function(e,t){var n=t.user,a=t.token;e.current_user=n,e.token=a,r["default"].axios.defaults.headers.common.Authorization=a}},actions:{registration:function(e,t){var n=e.commit,a=t.token,u=t.user;localStorage.setItem("token",a),localStorage.setItem("current_user",JSON.stringify(u)),n("authenticate",{user:u,token:a}),r["default"].prototype.$message({type:"success",duration:1e4,message:"Вы успешно зарегистрировались! На Ваш адрес электронной почты выслана инструкция для завершения регистрации."})},login:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t,n){var a,u,o,c,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.commit,e.prev=1,e.next=4,r["default"].axios.post("/sign_in",{sign_in:n});case 4:u=e.sent,o=u.data,c=o.user,s=o.token,localStorage.setItem("token",s),localStorage.setItem("current_user",JSON.stringify(c)),a("authenticate",{user:c,token:s}),r["default"].prototype.$message.success("Вы успешно вошли в систему"),r["default"].router.currentRoute.query.redirect?r["default"].router.push({path:r["default"].router.currentRoute.query.redirect}):r["default"].router.push("/"),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](1),r["default"].prototype.$message.error("Логин или пароль введены неверно");case 16:case"end":return e.stop()}},e,this,[[1,13]])}));return function(t,n){return e.apply(this,arguments)}}(),logged:function(e){var t=e.commit;t("authenticate",{token:localStorage.getItem("token"),user:JSON.parse(localStorage.getItem("current_user"))})},logout:function(e){var t=e.commit;localStorage.clear(),t("authenticate",{token:null,user:null}),r["default"].router.push({name:"Home"})}}},L=(n("7514"),{namespaced:!0,state:{types:[{key:"politics",value:"Политика"},{key:"tourism",value:"Туризм"},{key:"investments",value:"Инвестиции"},{key:"youth",value:"Молодежь"},{key:"hcs",value:"ЖКХ"},{key:"transport",value:"Транспорт"},{key:"roads",value:"Дороги"},{key:"health",value:"Здравоохранение"},{key:"leisure",value:"Досуг"}]},getters:{getTypeByKey:function(e){return function(t){return e.types.find(function(e){return e.key===t})}}}});r["default"].use(v["a"]);var F=!1,B=new v["a"].Store({modules:{auth:I,surveys:L},strict:F});r["default"].store=B;var J=B;r["default"].use(N["a"]);var M=new N["a"]({base:"/efco/",routes:[{path:"/",alias:"/confirmation",name:"Home",component:function(){return n.e("chunk-534068b0").then(n.bind(null,"bb51"))}},{path:"/login",name:"Login",component:function(){return n.e("chunk-58e66fec").then(n.bind(null,"a55b"))}},{path:"/registration",name:"Registration",component:function(){return n.e("chunk-5cd09936").then(n.bind(null,"3fd1"))}},{path:"/about",name:"About",meta:{auth:!0},component:function(){return n.e("chunk-2d22d746").then(n.bind(null,"f820"))}},{path:"/dashboard",name:"Dashboard",redirect:{name:"DashboardSurveys"},meta:{auth:!0,dashboard:!0},component:function(){return n.e("chunk-0ab3d7eb").then(n.bind(null,"0a6e"))},children:[{path:"surveys",name:"DashboardSurveys",meta:{auth:!0,dashboard:!0},component:function(){return Promise.all([n.e("chunk-2d20ec05"),n.e("chunk-952425b4")]).then(n.bind(null,"ebc8"))}},{path:"surveys/new",name:"DashboardSurveysNew",meta:{auth:!0,dashboard:!0},component:function(){return n.e("chunk-09fb40aa").then(n.bind(null,"567f"))}},{path:"surveys/:id",props:!0,name:"DashboardSurveysShow",meta:{auth:!0,dashboard:!0},component:function(){return n.e("chunk-7b9a9d51").then(n.bind(null,"bf5a"))}},{path:"surveys/:id/statistics",props:!0,name:"DashboardSurveysStatistics",meta:{auth:!0,dashboard:!0},component:function(){return n.e("chunk-a5d9095a").then(n.bind(null,"86ac"))}},{path:"appeals",name:"DashboardAppeals",meta:{auth:!0,dashboard:!0},component:function(){return Promise.all([n.e("chunk-2d20ec05"),n.e("chunk-a4aea362")]).then(n.bind(null,"4d44"))}},{path:"users",name:"DashboardUsers",meta:{auth:!0,dashboard:!0},component:function(){return n.e("chunk-8c4d3afa").then(n.bind(null,"c91a"))}},{path:"users/:id",props:!0,name:"DashboardUsersShow",meta:{auth:!0,dashboard:!0},component:function(){return n.e("chunk-35ce3fa2").then(n.bind(null,"aa74"))}}]},{path:"/surveys",name:"Surveys",component:function(){return n.e("chunk-628e6a2a").then(n.bind(null,"268d"))}},{path:"/surveys/:id",name:"SurveyPassing",props:!0,component:function(){return n.e("chunk-ca4bd1ba").then(n.bind(null,"fcdf"))}},{path:"/account",name:"Account",meta:{auth:!0},component:function(){return Promise.all([n.e("chunk-2d20ec05"),n.e("chunk-f809d948")]).then(n.bind(null,"77be"))}},{path:"/appeals",name:"Appeals",component:function(){return n.e("chunk-357d883b").then(n.bind(null,"d18b"))}},{path:"*",redirect:"/"}]});M.beforeEach(function(e,t,n){e.matched.some(function(e){return e.meta.auth})?J.state.auth.current_user?n():(n({name:"Login",query:{redirect:e.path}}),r["default"].prototype.$message.warning("Войдите в систему")):"Login"===e.name&&J.state.auth.current_user?n(!1):n()}),r["default"].router=M;var U=M;n("a1de"),n("fbc3"),n("613e"),n("5ac3");r["default"].use(s.a,o.a),r["default"].use(l.a,{locale:f.a}),r["default"].use(p.a),r["default"].axios.defaults.baseURL="".concat("//psk35.int.netintel.ru:32713","/v1"),r["default"].axios.interceptors.request.use(function(e){return console.info("Starting Request: ",e),e},function(e){return Promise.reject(e)}),r["default"].axios.interceptors.response.use(function(e){return console.info("Getting Response: ",e),e},function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t.config.hasOwnProperty("localError")||!t.config.localError){e.next=2;break}return e.abrupt("return",Promise.reject(t));case 2:if(!t.response){e.next=20;break}console.log(t.response),e.t0=t.response.status,e.next=401===e.t0?7:403===e.t0?11:404===e.t0?13:405===e.t0?15:17;break;case 7:return r["default"].prototype.$message.warning("Время сессии истекло"),e.next=10,J.dispatch("auth/logout");case 10:return e.abrupt("break",18);case 11:return r["default"].prototype.$message.error("Доступ к ресурсу запрещен"),e.abrupt("break",18);case 13:return r["default"].prototype.$message.error("Информация не найдена"),e.abrupt("break",18);case 15:return r["default"].prototype.$message.error("Действие недоступно"),e.abrupt("break",18);case 17:r["default"].prototype.$message.error("Что-то пошло не так");case 18:e.next=21;break;case 20:t.request?r["default"].prototype.$message.error("Нет соединения с сервером"):r["default"].prototype.$message.error("Ошибка. Обновите страницу");case 21:return e.abrupt("return",Promise.reject(t));case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}());var z=localStorage.getItem("token");z&&J.dispatch("auth/logged"),r["default"].config.productionTip=!1,new r["default"]({router:U,store:J,render:function(e){return e(D)}}).$mount("#app")},"5ac3":function(e,t,n){},"5c0b":function(e,t,n){"use strict";var a=n("5e27"),r=n.n(a);r.a},"5e27":function(e,t,n){},"613e":function(e,t,n){},8113:function(e,t,n){},"9f87":function(e,t,n){"use strict";var a=n("2925"),r=n.n(a);r.a},a1de:function(e,t,n){},b18b:function(e,t,n){"use strict";var a=n("8113"),r=n.n(a);r.a},cf05:function(e,t,n){e.exports=n.p+"img/logo.9ccd11a1.png"},fbc3:function(e,t,n){}});
//# sourceMappingURL=app.79ec5246.js.map